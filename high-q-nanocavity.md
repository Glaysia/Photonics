# High-Q Photonic Nanocavity in a 2D Photonic Crystal (Akahane et al., Nature 2003)

논문 `High-Q photonic nanocavity in a two-dimensional photonic crystal`(repo의 `nature02063.pdf`) 핵심 요약과 시뮬레이션 재현 가이드.

## 논문이 한 일(조금 더 자세히)
- 기판에서 부유한 GaAs 슬랩(두께 ~0.25 µm, a=0.42 µm, r=0.29a)에 삼각 격자 공기홀을 만든 뒤 L3 결함을 도입.
- 결함 가장자리 홀을 소량 외측으로 이동시키며(첫 이웃 ±0.15a, 두 번째 ±0.05a) 필드 공간 분포를 가우시안 형태에 가깝게 만들어 슬랩 밖으로 방사되는 k-성분을 줄임.
- 실험적으로 Q≈4.5×10^4을 달성(기본 L3 대비 약 20배 개선), 모드부피는 (λ/n)^3 정도로 작게 유지.
- 자기 발광(InAs QD)으로 모드를 여기해 PL 스펙트럼에서 공진선폭을 측정하고 Q를 얻음. FSR이 넓어 단일 모드 성능이 뚜렷함.

## 고Q가 나오는 원리(k-공간 관점)
- 슬랩 위/아래로 새는 방사는 주로 공진 모드의 k-성분이 공기 라이트콘(|k_| ≤ ω/c) 안쪽에 있을 때 발생.
- 결함 주변 홀을 급격히 자르면 필드 외피가 급변 → 공간 푸리에 스펙트럼에 높은 k-꼬리가 생겨 라이트콘 안 성분이 커짐 → Q 낮아짐.
- 에지 홀을 부드럽게 이동/축소해 필드 외피를 가우시안으로 만들면 k-스펙트럼이 중앙 집중 → 라이트콘 안 성분이 억제 → 수직 방사 손실이 크게 줄어 Q 상승.
- 변위·반경 조정이 커질수록 Q는 오르지만 공진 주파수가 밴드갭 가장자리로 이동할 수 있으므로 r, t, a와 함께 맞춰야 함.

## 개념 포인트
- 슬랩(고굴절률 n≈3.4, 두께 t≈0.5–0.6a)에 삼각 격자 공기홀(r≈0.28–0.32a) → TE 밴드갭 생성.
- L3 결함(Γ–K 방향 3개 홀 제거) 주변 홀을 소량 외측으로 이동·반경 미세 조정해 필드의 k-공간 분포를 가우시안 형태로 완만히 제한(gentle confinement) → 수직 방사 성분 억제 → Q 급상승.
- 보고 성능: Q ≈ 4.5×10^4, 모드부피 V ≈ 0.8–1.0 (λ/n)^3 수준.

## 기본 구조/파라미터(초기값)
- 격자상수 a: 목표 파장 λ와 n_eff로 스케일(예: λ=1.55 µm, n_eff≈2.7 → a≈0.55–0.60 µm).
- 홀 반경 r: 0.30a (0.28–0.32a 범위 스윕).
- 슬랩 두께 t: 0.50a.
- 결함: 3-hole 삭제.
- 인접 홀 이동: 첫 이웃 ±0.15a, 두 번째 ±0.05a; 필요 시 에지 홀 반경을 0.01–0.02a 축소.

## 재현용 시뮬레이션 워크플로(조금 더 구체적)
1) 밴드 구조(MPB/MPG): Γ–M–K–Γ에서 TE-like 밴드갭 위치 확인 → 목표 공진이 갭 중앙에 오도록 r, t, a 조정.
2) 결함 모델링: L3 결함 생성 후 인접 홀 변위(Δx1, Δx2)와 반경(r_edge) 변수를 파라메트릭으로 노출.
3) 결함 모드 찾기(FDTD/FDFD): 슈퍼셀 x,y에 ≥10a, z에 PML(1–2 µm 또는 ≥8셀) 적용, 주기경계 대신 PML로 고립 캐비티 방사 포착.
4) 여기/분석: 짧은 가우시안 전류(Ex/Ey)로 여기 → 시간 신호를 Harminv·Prony로 피팅해 공진 주파수와 감쇠율(=Q) 추출. 필드 스냅샷으로 E, H 분포 시각화.
5) Q·V 계산: Q = Re(ω)/(2 Im(ω)), V = ∫ε|E|^2 dV / (ε|E|max^2). Poynting 박스로 z-방사, 측방 방사를 분리해 손실 채널별 기여 확인.
6) 최적화: Δx1, Δx2, r_edge를 스윕하며 Q vs 주파수 이동량을 기록. Δx 증가 → Q 상승, 주파수 소폭 이동 → 밴드갭 중앙 유지 여부 체크.

## FDTD 설정 체크리스트
- 해상도: 20–32 pixels per a(두께 방향 충분히 촘촘하게).
- 시뮬 시간: 고Q 모드면 링다운이 길어지므로 충분히 길게 설정.
- 대칭 활용: 구조가 대칭일 때 미러 대칭 경계로 계산량 감소(홀 변위가 비대칭이면 해제).
- 모니터: 에너지 적분 영역을 캐비티 주변에, Poynting 플럭스 박스를 PML 직전에 배치.

## 검증 포인트
- 모드 주파수가 TE 밴드갭 중앙 근방에 위치하는지 확인.
- k-공간 플럭스에서 수직(Γ 방향) 방사가 억제되는지 확인.
- 링다운 신호가 단일 지수로 잘 맞는지(다중 모드 섞임 시 더 긴 시뮬 시간·필터 소스 사용).

## 실험적 고려
- 무손실 모델은 실제보다 Q가 높게 나올 수 있음(표면 거칠기, 측벽 테이퍼 미포함).
- 제조 오차 민감도: Δx1, Δx2를 ±0.02a 변동시키며 Q 변화를 확인해 허용오차 추정.

## MFEM 관련 메모(FDTD 질문)
- MFEM은 유한요소 라이브러리라 전통적인 Yee 격자 FDTD를 내장하지 않음.
- 대신 curl-conforming Nedelec 요소(시간 영역)나 DG로 Maxwell을 적분하는 코드를 짤 수 있고, 형상이 매끄럽게 표현되는 장점이 있으나 스텐실·메쉬 제너레이션이 FDTD와 다름.
- 빠른 재현/스윕 목적이면 MEEP/MPB 같은 FDTD/Bloch 도구가 효율적, MFEM은 (1) 고유값 문제로 모드 주파수·Q 추정, (2) 시간 영역 FE로 링다운 계산(예: ex22 스타일) 쪽에 적합.
- 시간 영역 FE를 사용할 때는 PML 구현, 재질 분포(ε, µ), 에너지/플럭스 후처리를 직접 맞춰야 하고, Yee FDTD 대비 CFL 조건이 다름을 유의.

## C++ 워크플로 선택: MEEP vs MFEM
- 목표: 빠른 재현/스윕 → MEEP C++ API(FDTD+PML+Harminv 내장), 밴드 구조는 MPB(C) 병행. 코드량 최소, Q 측정 바로 가능.
- 목표: 형상/재질 커스텀, 고차 곡면·비직교 메쉬, FE 연구 → MFEM. Nedelec/DG로 Maxwell 고유값 또는 시간 영역 적분을 직접 구성.
- MEEP 장점: PML/소스/모니터/Harminv/서브픽셀 스무딩 기본 제공, 고Q 링다운 자동화 용이. 단점: 유한차 격자라 홀 경계가 계단화, C++ API 예제가 적음(하지만 Python 예제를 그대로 포팅 가능).
- MFEM 장점: 고차 곡면 요소로 홀 경계를 매끄럽게 표현, SLEPc/Hypre와 결합한 고유값 솔버 가능, GPU 백엔드 지원. 단점: FDTD 내장 없음 → 시간 적분 스킴·PML·소스/관측을 모두 직접 작성해야 함.
- 절충안: (1) MEEP/MPB로 파라미터 튜닝·Q 예측, (2) MFEM으로 최종 형상(곡면/불균일 두께) 고유값 및 시간 영역 검증. 이렇게 하면 빠른 반복과 고정밀 해석을 모두 확보 가능.
